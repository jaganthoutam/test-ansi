---
  - name: Playbook
    hosts: webserver
    become: yes
    become_user: root
    tasks:
      - name: Check if Service Exists
        stat: path=/etc/init.d/httpd
        register: service_status
        
      - name: Stop Service
        service: name=httpd state=stopped
        when: service_status.stat.exists
        
      - name: ensure apache is at the latest version
        yum:
          name: httpd
          state: latest
      - name: ensure apache is running
        service:
          name: httpd
          state: started
          
      - name: Make sure a service is running
        systemd: state=started name=httpd

      - name: stop service cron on debian, if running
        systemd: name=cron state=stopped

      - name: restart service cron on centos, in all cases, also issue daemon-reload to pick up config changes
        systemd:
          state: restarted
          daemon_reload: yes
          name: crond

      - name: reload service httpd, in all cases
        systemd:
          name: httpd
          state: reloaded

      - name: enable service httpd and ensure it is not masked
        systemd:
          name: httpd
          enabled: yes
          masked: no

      - name: enable a timer for dnf-automatic
        systemd:
           name: dnf-automatic.timer
           state: started
           enabled: True

      - name: just force systemd to reread configs (2.4 and above)
        systemd: daemon_reload=yes
