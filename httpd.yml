---
  - name: Playbook
    hosts: webserver
    become: yes
    become_user: root
    tasks:
      - name: Check if Service Exists
        stat: path=/etc/init.d/httpd
        register: service_status
        
      - name: Stop httpd graceful
        command: httpd -k graceful-stop

      - name: Waits for port 80 of any IP to close active connections, don't start checking for 10 seconds
        wait_for:
          host: 0.0.0.0
          port: 80
          delay: 15
          state: drained
