---
  - name: Playbook
    hosts: webserver
    become: yes
    become_user: root
    tasks:
      - name: Check if Service Exists
        stat: path=/etc/init.d/httpd
        register: service_status
        
      - command: service httpd status
        args:
        warn: false
        
      - name: Stop Service
        service: name=httpd state=stopped
        when: service_status.stat.exists
        register: service_stopped
        
      - name: ensure apache is at the latest version
        yum:
          name: httpd
          state: latest
      - name: ensure apache is running
        service:
          name: httpd
          state: started
